import{r as n}from"./index-DBgWNnxV.js";import{O as o,aj as m}from"./three.module-DquJvn9e.js";import{b as A}from"./CanvasLoader-BIPX06uZ.js";function j(c,t){const i=n.useRef(),[r]=n.useState(()=>t?t instanceof o?{current:t}:t:i),[u]=n.useState(()=>new m(void 0));n.useLayoutEffect(()=>{t&&(r.current=t instanceof o?t:t.current),u._root=r.current});const s=n.useRef({}),f=n.useMemo(()=>{const a={};return c.forEach(e=>Object.defineProperty(a,e.name,{enumerable:!0,get(){if(r.current)return s.current[e.name]||(s.current[e.name]=u.clipAction(e,r.current))},configurable:!0})),{ref:r,clips:c,actions:a,names:c.map(e=>e.name),mixer:u}},[c]);return A((a,e)=>u.update(e)),n.useEffect(()=>{const a=r.current;return()=>{s.current={},u.stopAllAction(),Object.values(f.actions).forEach(e=>{a&&u.uncacheAction(e,a)})}},[c]),f}export{j as u};
